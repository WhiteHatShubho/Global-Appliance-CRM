<!DOCTYPE html>
<html>
<head>
    <title>Firebase Connection Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .log { background: #f5f5f5; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .error { color: red; }
        .success { color: green; }
        .info { color: blue; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:disabled { background: #ccc; }
    </style>
</head>
<body>
    <h1>Firebase Connection Test</h1>
    
    <button id="testBtn">Run Firebase Test</button>
    <div id="results"></div>

    <script type="module">
        // Import Firebase
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
        import { getAuth } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js';
        import { getDatabase, ref, set } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDN_WvokwbsKaHJMd70hscE030DTNFfZxI",
            authDomain: "service-management-syste-5a9f5.firebaseapp.com",
            databaseURL: "https://service-management-syste-5a9f5-default-rtdb.firebaseio.com",
            projectId: "service-management-syste-5a9f5",
            storageBucket: "service-management-syste-5a9f5.firebasestorage.app",
            messagingSenderId: "719700732732",
            appId: "1:719700732732:web:0cbc53d5e99f66cb148c39"
        };

        let app, auth, db;
        const results = document.getElementById('results');
        const testBtn = document.getElementById('testBtn');

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.textContent = message;
            results.appendChild(div);
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        async function runTest() {
            results.innerHTML = '';
            testBtn.disabled = true;
            log('Starting Firebase connection test...');

            try {
                // Test 1: Initialize Firebase App
                log('Test 1: Initializing Firebase App...', 'info');
                app = initializeApp(firebaseConfig);
                log('‚úÖ Firebase App initialized successfully', 'success');

                // Test 2: Initialize Auth
                log('Test 2: Initializing Firebase Auth...', 'info');
                auth = getAuth(app);
                log('‚úÖ Firebase Auth initialized successfully', 'success');

                // Test 3: Initialize Database
                log('Test 3: Initializing Firebase Database...', 'info');
                db = getDatabase(app);
                log('‚úÖ Firebase Database initialized successfully', 'success');

                // Test 4: Write to Database
                log('Test 4: Testing database write...', 'info');
                const testRef = ref(db, 'test/connection');
                await set(testRef, {
                    timestamp: new Date().toISOString(),
                    status: 'connected',
                    userAgent: navigator.userAgent
                });
                log('‚úÖ Database write successful', 'success');

                log('üéâ All tests passed! Firebase connection is working correctly.', 'success');
            } catch (error) {
                log(`‚ùå Test failed: ${error.message}`, 'error');
                log(`Error code: ${error.code || 'N/A'}`, 'error');
                log(`Stack trace: ${error.stack || 'N/A'}`, 'error');
            } finally {
                testBtn.disabled = false;
            }
        }

        testBtn.addEventListener('click', runTest);
    </script>
</body>
</html>